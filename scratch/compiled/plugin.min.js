!function(){e=0;var e,i=function(){return"heading-".concat(++e)},t=function(e){for(var t=/<(h[1-8])([^>]*id="([^"]+)"[^>]*)>/gi,n=[];null!==(l=t.exec(e));){var a=l[1],i=parseInt(a.replace(/\D/g,""),10),o=l[3],l=(null==(l=l.input.split(">").pop())?void 0:l.split("<")[0])||"";n.push({tag:a,level:i,text:l,id:o})}return n},c=function(e,t){var a=e.getContent({format:"html"});t.forEach(function(e){var t="h".concat(e.level),n=e.tag,e=e.id,n=new RegExp("(<".concat(n,'[^>]*id="').concat(e,'"[^>]*>)(.*)(</').concat(n,">)"),"gi");a=a.replace(n,"<".concat(t,' id="').concat(e,'">$2</').concat(t,">"))}),e.setContent(a)};tinymce.PluginManager.add("headings-test",function(r,e){r.ui.registry.addButton("headings-test",{text:"Hx",tooltip:"Adjust heading semantic levels",onAction:function(){var i=r.getContent({format:"html"}),o=t(i),l=0,n=function(e){e.setData({level:o[l].level.toString(),headingText:o[l].text,isFirstHeading:0===l,isLastHeading:l===o.length-1})},a=function(e,t){return{title:"Headings",size:"normal",body:{type:"panel",items:[{type:"htmlpanel",html:'<p id="heading-text" style="font-family: Courier Sans;">'.concat(o[l].text,' <span style="font-weight: bold;">(Heading ').concat(l+1," of ").concat(o.length,")</span></p>")},{type:"input",name:"level",inputMode:"numeric",label:"Level",value:o[l].level.toString(),min:1,max:8,placeholder:"Enter heading level"}]},buttons:[{type:"custom",name:"prev",text:"Previous",primary:!1,disabled:e},{type:"custom",name:"next",text:"Next",primary:!1,disabled:t},{type:"cancel",text:"Cancel"},{type:"submit",text:"OK",primary:!0}],initialData:{level:o[l].level.toString(),headingText:o[l].text,isFirstHeading:e,isLastHeading:t},onChange:function(e,t){},onAction:function(e,t){"next"===t.name?l<o.length-1&&(l++,e.redial(a(0===l,l===o.length-1)),n(e)):"prev"===t.name&&0<l&&(l--,e.redial(a(0===l,l===o.length-1)),n(e))},onSubmit:function(e){var t=e.getData(),t=(o[l].level=parseInt(t.level,10),o[l].level),n=(new DOMParser).parseFromString(i,"text/html").querySelectorAll('h1, h2, h3, h4, h5, h6, [role="heading"][aria-level]'),a=0;n.forEach(function(e){"h1"===e.tagName.toLowerCase()&&a++}),1===a&&1===t?r.notificationManager.open({text:"Only one Heading 1 can exist at a time.",type:"error",timeout:3e3}):c(r,o),e.close()}}},e=r.windowManager.open(a(0===l,l===o.length-1));n(e)}}),r.on("NodeChange",function(e){var t=r.getContent({format:"html"}),n=(new DOMParser).parseFromString(t,"text/html"),t=n.querySelectorAll('h1, h2, h3, h4, h5, h6, [role="heading"][aria-level]'),a=!1;t.forEach(function(e){e.id||(e.id=i(),a=!0)}),a&&r.undoManager.transact(function(){r.setContent(n.body.innerHTML,{format:"raw"}),r.selection.setCursorLocation(n.body.lastChild,0)})})})}();